/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
var __awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(s,o){function i(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,a)}c((r=r.apply(t,e||[])).next())}))};define(["require","exports","../BackwardCompat/JQueryNativePromises","./AjaxResponse","./ResponseError","./InputTransformer"],(function(t,e,n,r,s,o){"use strict";class i{constructor(t){this.queryArguments="",this.url=t,this.abortController=new AbortController,n.default.support()}withQueryArguments(t){const e=this.clone();return e.queryArguments=(""!==e.queryArguments?"&":"")+o.InputTransformer.toSearchParams(t),e}get(t={}){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.send(Object.assign(Object.assign({},{method:"GET"}),t));return new r.AjaxResponse(e)}))}post(t,e={}){return __awaiter(this,void 0,void 0,(function*(){const n={body:"string"==typeof t?t:o.InputTransformer.toFormData(t),cache:"no-cache",method:"POST"},s=yield this.send(Object.assign(Object.assign({},n),e));return new r.AjaxResponse(s)}))}put(t,e={}){return __awaiter(this,void 0,void 0,(function*(){const n={body:"string"==typeof t?t:o.InputTransformer.toFormData(t),cache:"no-cache",method:"PUT"},s=yield this.send(Object.assign(Object.assign({},n),e));return new r.AjaxResponse(s)}))}delete(t={},e={}){return __awaiter(this,void 0,void 0,(function*(){const n={cache:"no-cache",method:"DELETE"};"object"==typeof t&&Object.keys(t).length>0?n.body=o.InputTransformer.toFormData(t):"string"==typeof t&&(n.body=t);const s=yield this.send(Object.assign(Object.assign({},n),e));return new r.AjaxResponse(s)}))}getAbort(){return this.abortController}clone(){return Object.assign(Object.create(this),this)}send(t={}){return __awaiter(this,void 0,void 0,(function*(){const e=yield fetch(this.composeRequestUrl(),this.getMergedOptions(t));if(!e.ok)throw new s.ResponseError(e);return e}))}composeRequestUrl(){let t=this.url;if("?"===t.charAt(0)&&(t=window.location.origin+window.location.pathname+t),t=new URL(t,window.location.origin).toString(),""!==this.queryArguments){t+=(this.url.includes("?")?"&":"?")+this.queryArguments}return t}getMergedOptions(t){return Object.assign(Object.assign(Object.assign({},i.defaultOptions),t),{signal:this.abortController.signal})}}return i.defaultOptions={credentials:"same-origin"},i}));